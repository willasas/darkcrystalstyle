<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/video-js.min.css">
  <title>video js demo</title>
</head>
<body>
  <div class="data-vjs-player">
    <!-- type1-- via data-setup -->
    <video id="vid1" class="video-js" data-setup="{}">
      <source src="//vjs.zencdn.net/v/oceans.mp4" type="video/mp4">
      <source src="//vjs.zencdn.net/v/oceans.webm" type="video/webm">
    </video>
    <!-- <video id="vid1" class="video-js" data-setup='{"controls": true, "autoplay": false, "preload": "auto"}'></video> -->
  </div>

  <!-- type2-- video-js embed -->
  <video-js id="vid2" class="video-js" data-setup="{}">
    <source src="//vjs.zencdn.net/v/oceans.mp4" type="video/mp4">
    <source src="//vjs.zencdn.net/v/oceans.webm" type="video/webm">
  </video-js>

  <!-- video.js 视频插件 -->
  <script src="js/video.min.js"></script>
  <!-- 检测浏览器是否支持(音频、视频)自动播放 -->
  <script src="js/can-autoplay.js"></script>

  <script>
    // type 1 
    // 若在video标签中的data-setup属性中配置了controls，autoplay和preload等属性，这此js中的参数不需要配置；即二选一
    const player = videojs('vid1', {
      controls: true,
      autoplay: 'muted',
      preload: 'auto',
      crossorigin: 'anonymous',
      poster: 'https://lh6.googleusercontent.com/proxy/MdXBfxi4vCF0ZKalCD1XFNnrumrgr3DoIIwdqaPlZG9Q0K4hUVQQUGfBnqzm3-jY1EJEREorVqCj7TUKyEqhPiz32FyE051g9G8sMKhGdyM=w3840-h2160-p-k-no-nd-mv',
    });
    // or the videojs function accepts a DOM element instead
    // const player = videojs(document.querySelector('vid1'));
    // 传递一个回调函数给player的ready()方法
    player.ready(function() {
      // 自动播放检测
      const promise = player.play();

      if(promise !== undefined){
        promise.then(function(){
          // Autoplay started!
          console.log('autoplay started!')
        }).catch(function(error){
          // Autoplay was prevented.
          console.log('autoplay was prevented.')
        })
      }
    });
    // 监听player的ready事件
    player.on('ready', function(){
      this.addClass('my-example');
    });



    // type 2
    const jsplayer = videojs('vid2', {
      controls: true,
      autoplay: false,
      preload: 'auto'
    });
    // or the videojs function accepts a DOM element instead
    // const jsplayer = videojs(document.querySelector('vid2'));


    // can-autoplay.js检测自动播放
    // 浏览器是否支持音频自动播放
    canAutoplay.audio().then(({result}) => {
      if (result === true) {
        // Can auto-play
      } else {
        // Can not auto-play
      }
    })

    // 浏览器是否支持视频自动播放
    canAutoplay.video().then(({result}) => {
      if (result === true) {
        // Can autoplay
      } else {
        // Can not autoplay
      }
    })
  </script>
</body>
</html>